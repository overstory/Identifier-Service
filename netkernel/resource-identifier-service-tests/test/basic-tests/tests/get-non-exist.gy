import org.netkernel.layer0.nkf.INKFRequestContext

import static com.jayway.restassured.RestAssured.given;
import static org.hamcrest.Matchers.*;

import javax.xml.namespace.NamespaceContext

INKFRequestContext context = context
String svcroot = context.source("arg:svcroot")

def NamespaceContext namespaces = context.source ("active:idsvc-namespaces-context", NamespaceContext.class)

// Assert non-empty body and not found error result for the requested resource
given()
        .header ("Accept", "application/vnd.iop.meta.id+xml")
.when()
        .get ("${svcroot}/identifier/id/something-very-unlikely-to-exist".toString())
.then()
        .statusCode (404)
        .body (not (empty()))
        .body (hasXPath ("/e:errors/e:resource-not-found/e:uri", namespaces, equalTo ('something-very-unlikely-to-exist')))
;

context.createResponseFrom("")


